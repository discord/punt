{
  "clusters": {
    "default": {
      "datastores": {
        "ch": {
          "type": "clickhouse",
          "config": {
            "url": "tcp://127.0.0.1:9000",
            "batcher": {
              "batchsize": 1,
              "maxretries": 3,
              "backoff": 1000,
              "maxconcurrentcommits": 12
            },
            "types": {
              "*": {
                "table": "test",
                "fields": {
                  "content": {
                    "source": "content"
                  }
                }
              },
              "json": {
                "table": "json",
                "fields": {
                  "field1": "field1",
                  "field2": "field2"
                }
              }
            }
          }
        },
        "es": {
          "type": "elasticsearch",
          "config": {
            "url": "http://localhost:9200",
            "batcher": {
              "batchsize": 1,
              "maxretries": 3,
              "backoff": 1000,
              "maxconcurrentcommits": 12,
              "drop": true
            },
            "types": {
              "*": {
                "prefix": "test-",
                "dateformat": "2006.01.02.15",
                "mappingtype": "test"
              },
              "json": {
                "prefix": "json-",
                "dateformat": "2006.01.02.15",
                "mappingtype": "json"
              }
            },
            "mappings": {
              "test": {
                "fields": {
                  "test": {
                    "type": "text",
                    "index": true
                  }
                }
              },
              "json": {
                "fields": {
                  "field1": {
                    "type": "integer",
                    "index": true
                  },
                  "field2": {
                    "type": "text",
                    "index": true
                  }
                }
              }
            }
          }
        }
      },
      "num_workers": 1,
      "bulk_size": 3,
      "commit_interval": 0,
      "servers": [
        {
          "type": "udp",
          "bind": "localhost:5679"
        },
        {
          "type": "tcp",
          "bind": "localhost:5678",
          "octet_counted": true
        }
      ],
      "debug": true
    }
  },
  "types": {
    "*": {
      "transformer": {
        "name": "direct"
      },
      "prune": 1
    },
    "json": {
      "transformer": {
        "name": "unpack-merge"
      },
      "field_types": {
        "field1": "int"
      }
    }
  },
  "alerts": {
    "magic-word-found": {
      "type": "match",
      "sources": ["*"],
      "rollup_window": 2,
      "config": {
        "source": "content",
        "match": "^ magic.*",
        "title": "FOUND MAGIC",
        "description": "{{.content}}",
        "fields": {
          "hostname": "{{.hostname}}",
          "timestamp": "{{.timestamp}}"
        }
      },
      "action": "discord-alert"
    }
  },
  "actions": {
    "discord-alert": {
      "type": "discord",
      "config": {
        "url": "???",
        "color": 16738657
      }
    }
  },
  "control_socket": {
    "enabled": true,
    "bind": "localhost:1234"
  }
}
